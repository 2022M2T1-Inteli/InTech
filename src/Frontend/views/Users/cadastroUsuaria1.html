<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="../../styles/styleUsers/cadastroUsuaria1.css">
    <link rel="stylesheet" href="../../styles/main.css">

    <title>Brazilians in Tech</title>
</head>


<body class="bg-image" style="background-image: url('../../images/Background.svg');
 background-repeat: no-repeat; background-size: cover; margin: 0;">


    <header>
        <nav>
            <img class="log" src="../../images/logo.svg" alt="Logo da Brazilians in Tech">
        </nav>
    </header>
    <main style="animation: up 1.5s;">
        <h1 class="titulo-da-pagina mt-4">Cadastre seu perfil</h1>
        <div>
            <p id="error" style="color: yellow;" class="d-flex justify-content-center"></p>
        </div>

        <form action="">
            <div class="caixa">
                <div class="mb-1 mt-4">
                    <img src="../../images/CadastroUsuaria1ProgressBar.svg" alt="barra de progresso 1 - seus dados"
                        srcset="">
                </div>
                <br>
                <label for="nomeCandidata">Nome</label>
                <input id="nomeCandidata" class="caixa2 border-0" type="text" placeholder="Digite seu nome"
                    name="Nome_candidata" required />
                <label for="emailCandidata">Email</label>
                <input id="emailCandidata" class="caixa2 border-0" type="email" placeholder="Digite seu melhor email"
                    name="Email_candidata" required />
                <label for="celularCandidata">Número de telefone celular</label>
                <input id="celularCandidata" class="caixa2 border-0" type="text" value="(__) _____-____"
                    data-mask="(__) _____-____" placeholder="Digite o número do seu celular" name="Celular_candidata" />

                <label for="cpfCandidata">CPF</label>
                <input id="cpfCandidata" value="___.___.___-__" data-mask="___.___.___-__" class="caixa2 border-0" type="text" placeholder="Digite seu CPF"
                    name="CPF_candidata">

                <label for="pais">Selecione seu país</label>
                <select class="caixa2" name="Pais_candidata" id="pais">
                </select>
                <div class="mb-2 boxInputs">
                    <label for="estado">Selecione seu estado</label>
                    <select class="caixa4" name="UF_candidata" id="estado">
                    </select>
                    <label for="cidade">Selecione sua cidade</label>
                    <select class="caixa3" name="Cidade_candidata" id="cidade">
                    </select>
                </div>
                <div class="mb-2 boxInputs">
                    <label style="color: white; margin-left: 5px; margin-top: 10px;" class="row form-label"
                        for="data-nascimento">Data de nascimento: </label>
                    <input id="data-nascimento" class="caixa2 border-0" type="date" placeholder="Data de nascimento"
                        name="Data_nascimento">

                </div>
                <label for="genero">Informe seu gênero</label>
                <select class="caixa2 border-0" name="Genero_candidata" id="genero">
                    <option class="opt-disabled" value="" disabled hidden selected>Informe seu gênero</option>
                    <option value="mulher-cis">Mulher-Cis</option>
                    <option value="homem-cis">Homen-Cis</option>
                    <option value="mulher-cis">Mulher Trans</option>
                    <option value="homem-trans">Homem Trans</option>
                    <option value="nao-binario">Não-Binário</option>
                    <option value="nao-resposta">Prefiro não responder</option>
                </select>
                <label for="senha">Crie uma senha</label>
                <input id="senha" class="caixa2 border-0" name="Senha_candidata" type="password"
                    placeholder="Crie uma senha">
            </div>




        </form>

        <div class="avanço1">
            <button onclick="catchUserData()" class="btnproprio">Completar cadastro </button>
            <a onclick="deleteCatchDataUser()" class="row" style="margin-left: 30px;"
                href="../telaCadastro.html">Voltar</a>
        </div>

    </main>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-compat/3.0.0-alpha1/jquery.min.js"></script>

    <script>
        // Mascara CPF e Telefone
        Array.prototype.forEach.call(document.body.querySelectorAll("*[data-mask]"), applyDataMask); // coleta todos os inputs que conterem o atributo (data-mask)

        function applyDataMask(field) {
            var mask = field.dataset.mask.split('');


            function stripMask(maskedData) {
                function isDigit(char) {
                    return /\d/.test(char);
                }
                return maskedData.split('').filter(isDigit);
            }

            function applyMask(data) {// troca o que tiver '_' pelo número digitado
                return mask.map(function (char) {
                    if (char != '_') return char;
                    if (data.length == 0) return char;
                    return data.shift();
                }).join('')
            }

            function reapplyMask(data) {
                return applyMask(stripMask(data));
            }

            //atualiza o campo de acordo com o que já foi digitado
            function changed() {
                var oldStart = field.selectionStart;
                var oldEnd = field.selectionEnd;

                field.value = reapplyMask(field.value);

                field.selectionStart = oldStart;
                field.selectionEnd = oldEnd;
            }

            //EventListners para que a função seja executada a cada mudança de tecla
            field.addEventListener('click', changed)
            field.addEventListener('keyup', changed)
        }
        
        // API de Localização 
        function montaCidade(estado, pais) {
            $.ajax({
                type: 'GET',
                url: 'http://api.londrinaweb.com.br/PUC/Cidades/' + estado + '/' + pais + '/0/10000',
                contentType: "application/json; charset=utf-8",
                dataType: "jsonp",
                async: false
            }).done(function (response) {
                cidades = '';

                $.each(response, function (c, cidade) {

                    cidades += '<option value="' + cidade + '">' + cidade + '</option>';

                });

                // PREENCHE AS CIDADES DE ACORDO COM O ESTADO
                $('#cidade').html(cidades);

            });
        }

        function montaUF(pais) {
            $.ajax({
                type: 'GET',
                url: 'http://api.londrinaweb.com.br/PUC/Estados/' + pais + '/0/10000',
                contentType: "application/json; charset=utf-8",
                dataType: "jsonp",
                async: false
            }).done(function (response) {
                estados = '';
                $.each(response, function (e, estado) {

                    estados += '<option value="' + estado.UF + '">' + estado.UF + '</option>';

                });

                // PREENCHE OS ESTADOS BRASILEIROS
                $('#estado').html(estados);

                // CHAMA A FUNÇÃO QUE PREENCHE AS CIDADES DE ACORDO COM O ESTADO
                montaCidade($('#estado').val(), pais);

                // VERIFICA A MUDANÇA NO VALOR DO CAMPO ESTADO E ATUALIZA AS CIDADES
                $('#estado').change(function () {
                    montaCidade($(this).val(), pais);
                });

            });
        }

        function montaPais() {
            $.ajax({
                type: 'GET',
                url: 'http://api.londrinaweb.com.br/PUC/Paisesv2/0/1000',
                contentType: "application/json; charset=utf-8",
                dataType: "jsonp",
                async: false
            }).done(function (response) {

                paises = '';

                $.each(response, function (p, pais) {

                    if (pais.Pais == 'Brasil') {
                        paises += '<option value="' + pais.Sigla + '" selected>' + pais.Pais + '</option>';
                    } else {
                        paises += '<option value="' + pais.Sigla + '">' + pais.Pais + '</option>';
                    }

                });

                // PREENCHE O SELECT DE PAÍSES
                $('#pais').html(paises);

                // PREENCHE O SELECT DE ACORDO COM O VALOR DO PAÍS
                montaUF($('#pais').val());

                // VERIFICA A MUDANÇA DO VALOR DO SELECT DE PAÍS
                $('#pais').change(function () {
                    if ($('#pais').val() == 'BR') {
                        // SE O VALOR FOR BR E CONFIRMA OS SELECTS
                        $('#estado').remove();
                        $('#cidade').remove();
                        $('#campo_estado').append('<select id="estado"></select>');
                        $('#campo_cidade').append('<select id="cidade"></select>');

                        // CHAMA A FUNÇÃO QUE MONTA OS ESTADOS
                        montaUF('BR');
                    } else {
                        // SE NÃO FOR, TROCA OS SELECTS POR INPUTS DE TEXTO
                        $('#estado').remove();
                        $('#cidade').remove();
                        $('#campo_estado').append('<input type="text" id="estado">');
                        $('#campo_cidade').append('<input type="text" id="cidade">');
                    }
                })

            });
        }

        montaPais();

    </script>
    <script src="../../script/cadastroUsuaria1.js"></script>
    <script src="../../script/forms.js"></script>
</body>

</html>